<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FSBC - PROFESSIONAL TACTICAL SYSTEM</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&family=Poppins:wght@700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #6366f1;
            --primary-glow: rgba(99, 102, 241, 0.4);
            --bg-dark: #030712;
            --card-bg: rgba(15, 23, 42, 0.8);
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --font-main: 'Inter', sans-serif;
            --font-title: 'Poppins', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; }
        body { font-family: var(--font-main); background-color: var(--bg-dark); color: var(--text-main); min-height: 100vh; overflow-x: hidden; }
        
        #dynamic-bg { position: fixed; inset: 0; background: radial-gradient(circle at 50% 50%, #1e1b4b 0%, #030712 100%); z-index: -2; }

        /* HEADER */
        .site-header { width: 100%; padding: 20px; display: flex; justify-content: center; gap: 40px; background: rgba(0,0,0,0.4); backdrop-filter: blur(15px); border-bottom: 1px solid var(--glass-border); position: sticky; top: 0; z-index: 100; }
        .header-nav-item { color: #fff; text-decoration: none; font-size: 13px; font-weight: 700; opacity: 0.6; transition: 0.3s; cursor: pointer; text-transform: uppercase; letter-spacing: 1.5px; }
        .header-nav-item.active, .header-nav-item:hover { opacity: 1; color: var(--primary); }

        /* WIDOKI */
        .content-view { display: none; width: 100%; animation: fadeIn 0.4s ease-out; padding: 40px 20px; }
        .content-view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* KARTY TURNIEJÓW */
        .view-container-wide { width: 95%; max-width: 1400px; margin: 0 auto; }
        .section-title { font-family: var(--font-title); font-size: 48px; font-weight: 800; margin-bottom: 40px; letter-spacing: -2px; }
        .tournaments-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 25px; }
        
        .info-card { 
            background: var(--card-bg); border: 1px solid var(--glass-border); border-radius: 24px; padding: 30px; 
            transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; position: relative; overflow: hidden;
        }
        .info-card:hover { transform: scale(1.02); border-color: var(--primary); background: rgba(99, 102, 241, 0.05); }

        /* PRZYCISK POWROTU */
        .back-btn {
            display: inline-flex; align-items: center; gap: 12px; background: var(--glass); border: 1px solid var(--glass-border);
            color: #fff; padding: 14px 28px; border-radius: 18px; cursor: pointer; font-weight: 700; transition: 0.3s;
            margin-bottom: 30px; text-transform: uppercase; font-size: 12px; letter-spacing: 1px;
        }
        .back-btn:hover { background: rgba(255,255,255,0.1); transform: translateX(-5px); border-color: #fff; }

        /* ARCHIWUM LAYOUT - MAPA W KWADRACIE */
        .archive-layout { display: grid; grid-template-columns: 400px 1fr; gap: 30px; }
        .stats-panel { background: var(--card-bg); border-radius: 28px; padding: 30px; border: 1px solid var(--glass-border); }
        
        /* KLUCZOWA ZMIANA: MAPA IDEALNIE DOPASOWANA */
        .archive-map-container { 
            aspect-ratio: 1 / 1; /* Robi idealny kwadrat */
            background: #000; 
            border-radius: 28px; 
            overflow: hidden; 
            border: 1px solid var(--glass-border);
            position: relative;
        }
        #archive-map { width: 100%; height: 100%; }

        /* LEAFLET OVERLAY FIX - dopasowanie obrazu mapy */
        .leaflet-image-layer {
            object-fit: cover !important; /* To sprawia, że obraz wypełnia kwadrat jak na Twoim screenie */
        }

        .winner-row { display: flex; align-items: center; gap: 15px; padding: 18px; background: rgba(255,255,255,0.03); border-radius: 18px; margin-bottom: 10px; }
        .rank-badge { width: 36px; height: 36px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: 900; }

        .status-badge { padding: 6px 12px; border-radius: 8px; font-size: 10px; font-weight: 900; text-transform: uppercase; margin-bottom: 15px; display: inline-block; letter-spacing: 1px; }
    </style>
</head>
<body>

    <div id="dynamic-bg"></div>

    <header class="site-header">
        <div class="header-nav-item active" onclick="showView('home')">Główna</div>
        <div class="header-nav-item" onclick="showView('tournaments')">Turnieje</div>
        <div class="header-nav-item" onclick="showView('info')">Informacje</div>
    </header>

    <div id="view-tournaments" class="content-view">
        <div class="view-container-wide">
            <h1 class="section-title">Wybierz Turniej</h1>
            <div class="tournaments-grid" id="tournaments-list"></div>
        </div>
    </div>

    <div id="view-archive" class="content-view">
        <div class="view-container-wide">
            <button class="back-btn" onclick="showView('tournaments')">
                <i class="fa-solid fa-chevron-left"></i> Powrót do listy
            </button>
            
            <div class="archive-layout">
                <div class="stats-panel">
                    <h2 id="archive-title" style="font-family: var(--font-title); font-size: 32px; margin-bottom: 10px;"></h2>
                    <p id="archive-date" style="color: var(--text-muted); margin-bottom: 30px; font-weight: 600;"></p>
                    
                    <div id="archive-leaderboard"></div>
                </div>
                <div class="archive-map-container">
                    <div id="archive-map"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const tournaments = [
            { id: 5, title: "FSBC Solo #5", status: "active", date: "MARZEC 2026", winner: "TBD" },
            { id: 4, title: "FSBC Solo #4", status: "finished", date: "25 LUTY 2026", winner: "szimicarson6", results: [{n:"szimicarson6", p:500}, {n:"Player2", p:420}, {n:"Player3", p:380}] },
            { id: 1, title: "FSBC Solo #1", status: "finished", date: "06 STYCZEŃ 2026", winner: "szimicarson6", results: [{n:"szimicarson6", p:610}, {n:"Enemy", p:400}, {n:"Bot", p:50}] }
        ];

        let archMap;

        function init() {
            renderTournaments();
            archMap = L.map('archive-map', { crs: L.CRS.Simple, minZoom: -1, maxZoom: 2, zoomControl: false, attributionControl: false });
            archMap.setView([250, 250], 0);
        }

        function renderTournaments() {
            const container = document.getElementById('tournaments-list');
            container.innerHTML = tournaments.map(t => `
                <div class="info-card" onclick="openArchive(${t.id})">
                    <span class="status-badge" style="background:${t.status === 'active' ? 'var(--primary)' : 'rgba(255,255,255,0.1)'}">${t.status === 'active' ? 'Nadchodzi' : 'Zakończony'}</span>
                    <h2 style="font-family: var(--font-title); font-size: 28px; margin-bottom: 10px;">${t.title}</h2>
                    <p style="color:var(--text-muted); font-weight:700; font-size:14px;">${t.date}</p>
                    ${t.status === 'finished' ? `<p style="margin-top:20px; font-weight:600;">Zwycięzca: <span style="color:var(--primary)">${t.winner}</span></p>` : ''}
                </div>
            `).join('');
        }

        function openArchive(id) {
            const t = tournaments.find(x => x.id === id);
            if(t.status === 'active') return alert("Turniej jeszcze się nie odbył!");

            showView('archive');
            document.getElementById('archive-title').innerText = t.title;
            document.getElementById('archive-date').innerText = t.date;
            
            const lb = document.getElementById('archive-leaderboard');
            lb.innerHTML = t.results.map((r, i) => `
                <div class="winner-row">
                    <div class="rank-badge" style="background:${i === 0 ? '#fbbf24' : '#334155'}; color:#000">#${i+1}</div>
                    <div style="flex:1; font-weight:700;">${r.n}</div>
                    <div style="color:var(--primary); font-weight:800;">${r.p} PKT</div>
                </div>
            `).join('');

            // Ładowanie mapy Venture do kwadratu
            archMap.eachLayer(layer => { if(layer instanceof L.ImageOverlay) archMap.removeLayer(layer); });
            L.imageOverlay('https://i.ibb.co/fzjBkhTX/image.png', [[0, 0], [500, 500]]).addTo(archMap);
            
            setTimeout(() => archMap.invalidateSize(), 100);
        }

        function showView(v) {
            document.querySelectorAll('.content-view').forEach(e => e.classList.remove('active'));
            document.getElementById('view-' + v).classList.add('active');
            window.scrollTo(0,0);
        }

        init();
    </script>
</body>
</html>
